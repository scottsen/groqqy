# Changelog

All notable changes to Groqqy will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [2.3.0] - 2025-12-03

### Changed
- **Build system modernization**: Removed `setup.py` (redundant with `pyproject.toml`)
  - Now uses modern Python packaging exclusively (PEP 517/518)
  - `pyproject.toml` is the single source of truth for all project metadata
  - Simpler, cleaner build process aligned with Python 3.8+ standards
- **Documentation improvements**: Added comprehensive `RELEASE.md` with 6-phase release process
  - Includes rollback procedures, troubleshooting guide, and monitoring instructions
  - Documents PyPI Trusted Publishing setup and best practices
  - Complete version management and semantic versioning guidelines

### Fixed
- **Removed TIA-specific references**: Groqqy is now fully standalone for public use
  - Removed outdated TIA prerequisite from `CONTRIBUTING.md`
  - Replaced internal TIA documentation paths with public Groq API documentation
  - All examples, code, and documentation are now TIA-independent
  - Zero proprietary dependencies - works out of the box for all users

### Impact
- **Truly standalone**: External contributors need zero knowledge of TIA
- **Modern packaging**: Aligned with current Python best practices (PEP 517/518)
- **Better documentation**: Complete release process for maintainers
- **Public-ready**: Clean, professional library suitable for open-source use

## [2.2.2] - 2025-12-03

### Added
- **Optional tools parameter**: `Groqqy()` and `Agent()` now accept `tools=None` to disable tool-calling entirely, enabling pure LLM text generation mode
  - When `tools=None`, Groqqy runs in "pure LLM mode" without any tool-calling infrastructure
  - Useful for text generation, summarization, and scenarios where tool-calling interferes
  - Passes `tools=None` to Groq API (no tool schemas sent)
  - Strategy layer gracefully handles None tools with LocalToolStrategy fallback
  - Prevents default tool registry creation when explicitly disabled
- **Sentinel pattern for backwards compatibility**: Implemented `_USE_DEFAULTS` sentinel object to distinguish between omitted parameters and explicit `None`
  - `Groqqy()` ‚Üí creates default tool registry (backwards compatible)
  - `Groqqy(tools=None)` ‚Üí no tools (explicit disable)
  - `Groqqy(tools=registry)` ‚Üí uses custom registry
- **Comprehensive test coverage**: Added Test Suite 4 with 5 new tests for tools=None functionality (20/20 tests passing)

### Fixed
- **Critical security fixes**: Replaced 2 bare `except:` clauses in `exporter.py` (lines 74, 170) with specific exception types (`json.JSONDecodeError`, `TypeError`, `AttributeError`)
  - Prevents accidentally catching `SystemExit`, `KeyboardInterrupt`, and other system exceptions
  - Makes debugging and shutdown more reliable
- **PEP 8 compliance**: Fixed 30 long line violations (>88 chars) across 5 files:
  - `cli.py` (2 issues) - Multi-line strings with parentheses
  - `log.py` (2 issues) - Break format strings into parts
  - `executor.py` (3 issues) - Extract intermediate variables
  - `exporter.py` (18 issues) - Combined strategies for complex formatting
  - `groq.py` (5 issues) - Extract variables, multi-line f-strings
- **Code quality**: All modules now pass `reveal --check` with zero critical issues

### Changed
- **Build system modernization**: Removed `setup.py` (redundant with `pyproject.toml`)
  - Now uses modern Python packaging (PEP 517/518)
  - `pyproject.toml` is single source of truth for project metadata
- **Release process**: Added comprehensive `RELEASE.md` documentation
  - 6-phase release workflow with safety checkpoints
  - Rollback procedures and troubleshooting guide
  - PyPI Trusted Publishing documentation

### Impact
- **Enables clean fact extraction**: Scout v8 Pass 1 uses `--no-tools` for structured data extraction without tool-calling loops
- **3x faster generation**: Pure LLM mode with 8b models skips tool overhead
- **More robust error handling**: Won't accidentally catch system signals like KeyboardInterrupt
- **Production-ready**: Zero security issues, full PEP 8 compliance, 100% test pass rate
- **Modern packaging**: Aligned with current Python best practices (PEP 517/518)

## [2.2.1] - 2025-12-02

### Improved
- **Enhanced error handling for tool_use_failed**: Groq API 400 errors now show the malformed tool call format generated by the model, making debugging significantly easier
  - Displays the actual `failed_generation` field from Groq API response
  - Identifies the specific model that failed
  - Provides actionable hint: suggests `llama-3.3-70b-versatile` for reliable tool calling
  - Helps users understand the issue is model behavior, not schema generation

### Documentation
- **Model selection guide**: Added comprehensive documentation in README about choosing models for tool calling
  - Comparison table: llama-3.3-70b-versatile vs llama-4-scout vs llama-3.1-8b-instant
  - Known issue documentation: `tool_use_failed` errors with 8b models
  - Root cause explained: Some models wrap JSON in XML tags, causing API rejection
  - Cost/reliability trade-offs: 70b costs 3x more but works consistently
  - Links to official Groq documentation

### Impact
- **Faster debugging**: Users immediately see what went wrong instead of generic 400 error
- **Better model selection**: Clear guidance prevents production issues with unreliable models
- **Reduced support burden**: Self-service documentation for common tool calling issues

## [2.2.0] - 2025-12-02

### Fixed
- **Optional type handling in schema generation**: `_map_type()` now correctly handles `Optional[T]` and `Union[T, None]` types from Python's typing module, including nested generics like `Optional[List[str]]`
- Schema generation now properly marks optional parameters as not required while preserving correct type information

### Added
- **Line range support in read_file**: `read_file()` now accepts optional `start_line` and `end_line` parameters for reading specific sections of files
  - `read_file("file.txt", start_line=10, end_line=20)`: Read lines 10-20
  - `read_file("file.txt", start_line=50)`: Read from line 50 to end
  - `read_file("file.txt", end_line=100)`: Read first 100 lines
  - Maintains backwards compatibility (no parameters = full file read)
  - Includes bounds validation and improved error messages

### Testing
- Added comprehensive test suite for Optional type handling (7 tests)
- Added test suite for read_file line ranges (6 tests)
- Added test suite for tool schema generation with Optional parameters (2 tests)
- All 15 tests passing

### Impact
- **Unblocks Scout document analysis tools**: Can now extract specific sections from large files efficiently
- **Enables clean tool APIs**: Optional parameters work correctly with Groq API
- **Foundation for v2.x enhancements**: Type system improvements enable future tools

## [2.1.0] - 2025-12-01

### Added

**üé® Conversation Export**
- Full conversation export to Markdown and HTML formats
  - `bot.export_markdown()`: Export to clean markdown with code blocks
  - `bot.export_html()`: Export to styled HTML with embedded CSS (purple gradient theme)
  - `bot.save_conversation(filepath, format)`: Auto-detects format from extension
  - Interactive command: `export <format> <filepath>` during chat sessions
  - CLI flag: `--export <filepath>` for auto-export on exit
  - `ConversationExporter` component (362 lines): Single-responsibility formatter
  - Preserves complete conversation flow (user/assistant/tool messages and results)
  - Includes tool call visibility (JSON arguments + complete results)
  - Timestamps, message counts, and metadata
  - Perfect for documentation, debugging, and sharing agent behavior
  - New example: `examples/export_conversation.py`

**üéì Self-Discovery Pattern**
- Autonomous tool learning via minimal seed prompts
- 11-line MVP seed prompt enables agent to learn tools independently
- Agent reads tool documentation (e.g., `reveal --agent-help`) and learns autonomously
- Cost-efficient: ~$0.002-$0.004 per learning session
- Examples: `examples/reveal_mvp_demo.py`, `examples/self_discovery_demo.py`
- Documentation: `docs/SELF_DISCOVERY_SEED_PROMPT.md`, `docs/REVEAL_SEED_PROMPT_MVP.md`

**üß™ Container Testing Infrastructure**
- Reproducible testing with Podman/Docker
- `Containerfile`: Python 3.11 + groqqy + reveal-cli
- `test_container.py`: Automated 3-test suite (export, reveal, integration)
- `container_test.sh`: One-command testing
- `container_interactive.sh`: Interactive shell for debugging
- `demo_reveal_learning.sh`: Self-discovery demonstration script
- Clean environment validates no hidden dependencies
- Documentation: `docs/guides/CONTAINER_TESTING.md`

**üìö Documentation & Project Structure**
- **Documentation reorganization**:
  - Created `docs/` directory with logical structure
  - `docs/archive/`: Historical documents (5 files, 2,691 lines archived from root)
  - `docs/guides/`: Feature-specific guides (3 guides)
  - Moved `ARCHITECTURE.md` and `TEACHING_GUIDE.md` to `docs/`
  - Cleaned root from 15+ markdown files to 6 core files
- **Test organization**:
  - Created `tests/` structure with `unit/`, `integration/`, `examples/` subdirectories
  - Moved all test files from root to categorized locations
  - Added `pytest.ini` for consistent test execution
- **Examples enhancement**:
  - Added comprehensive `examples/README.md` with descriptions and usage
  - Organized 7 examples by category (Getting Started, Tools, Export, Platform, Self-Discovery)
  - Added troubleshooting section and best practices
- **New project files**:
  - `pyproject.toml`: Modern Python packaging with metadata and dev dependencies
  - `Makefile`: Common development tasks (install, test, lint, format, clean)
  - Updated `.gitignore`: Added patterns for test outputs and artifacts
- **Polished README.md**:
  - Reduced from 607 to 407 lines (33% reduction)
  - Cleaner structure focused on quick start and key features
  - Better navigation with links to comprehensive guides
  - Added cost comparison table and testing section

**üìù Enhanced Logging**
- Tool execution visibility improvements in `executor.py` and `agent.py`
- Shows command being executed, execution time, and data size
- Better debugging and monitoring capabilities

### Changed
- **Documentation structure**: Moved from flat root structure to organized `docs/` hierarchy
- **Test structure**: Organized from scattered root files to categorized `tests/` directory
- **README.md**: Streamlined to focus on essentials, moved detailed content to guides
- **Version**: Updated to 2.1.0 in `groqqy/__init__.py`, `setup.py`, and `pyproject.toml`

### Improved
- **Project cleanliness**: 43% reduction in root-level documentation (2,691 lines archived)
- **Navigation**: Clear documentation paths and comprehensive guides
- **Developer experience**: Makefile for common tasks, better test organization
- **First-time user experience**: Cleaner README, organized examples with index
- **Professional appearance**: Consistent structure following Python best practices

### Documentation
- `docs/USER_GUIDE.md`: Planned comprehensive usage guide
- `docs/ARCHITECTURE.md`: Moved and enhanced with export system details
- `docs/TEACHING_GUIDE.md`: Updated with new features
- `docs/guides/CONTAINER_TESTING.md`: Complete container testing guide
- `docs/guides/QUICK_START_NEW_FEATURES.md`: v2.1 feature quick start
- `docs/guides/REVEAL_LEARNING_DEMO.md`: Self-discovery demonstration
- `docs/SELF_DISCOVERY_SEED_PROMPT.md`: Comprehensive self-discovery guide
- `docs/REVEAL_SEED_PROMPT_MVP.md`: Minimal 11-line seed prompt
- `examples/README.md`: Complete examples index with usage and patterns

### Technical Details
- All exports preserve tool calls: function names, JSON arguments, and complete results
- HTML export uses embedded CSS (no external dependencies, works offline)
- Self-discovery pattern demonstrates meta-learning (agent learns how to learn)
- Container tests prove reproducibility and validate standalone operation
- Makefile supports modern Python dev workflow (black, flake8, mypy, pytest)
- pyproject.toml enables modern pip installation: `pip install -e ".[dev]"`

### Metrics
- **Code quality**: Excellent (clean structure, type hints, docstrings, no TODOs)
- **Documentation**: Reduced from 6,209 to ~3,500 lines at root (43% reduction)
- **Test organization**: 100% of tests now categorized in `tests/` directory
- **Examples**: 7 examples with comprehensive README and usage patterns
- **Project structure**: Professional, follows Python packaging best practices

## [2.0.0] - 2025-11-28

### Added
- **Strategy Pattern**: ToolExecutionStrategy abstraction for extensible tool execution
  - `LocalToolStrategy`: Function-based tools (read_file, run_command) execute locally
  - `PlatformToolStrategy`: Server-executed tools (browser_search, web_search) run on Groq's servers
  - `HybridToolStrategy`: Mix local + platform tools in same agent
  - `detect_strategy()`: Auto-detection selects appropriate strategy based on tool types
- **Platform Tool Support**: Integration with Groq Compound AI System
  - `registry.register_platform_tool("browser_search")` API
  - Server-side execution (no local tool_calls, results appear directly in response)
  - Compatible models: openai/gpt-oss-20b, Llama 4 Scout, Llama 3.3 70B
- **Web Search Capabilities**: browser_search powered by Tavily API
- **New Example**: `examples/example_web_search.py` demonstrating platform tools and hybrid usage

### Changed
- **Agent**: Added optional `strategy` parameter (auto-detected if not provided)
- **ToolRegistry**: Enhanced `to_schemas()` to merge function and platform tools
- **Agent Loop**: Delegates response handling to strategy pattern instead of hardcoded logic
- **Architecture**: Extended via Strategy Pattern (Open/Closed Principle)

### Technical Details
- `strategy.py`: 209 lines with extensive documentation and teaching focus
- Backward compatible: Existing code works unchanged without modifications
- Follows SOLID principles: Open/Closed (extend via new strategies without modifying Agent)
- Teaching microkernel: Each strategy includes "WHY THIS EXISTS" documentation
- Auto-detection prevents API complexity for beginners while allowing advanced control

## [1.0.0] - 2025-11-28

### Added - v0.3.0 Architecture Refactor
- **Agentic Loop**: Multi-step reasoning (THINK ‚Üí ACT ‚Üí OBSERVE pattern)
- **Agent Component** (175 lines): Orchestrates agentic loop with max_iterations safeguard
- **Tool Registry** (199 lines): Dynamic tool registration system
- **Composable Components**: ConversationManager, ToolExecutor, CostTracker
- **Provider Interface**: Abstract LLM provider for extensibility
- **Configuration System**: ~/.groqqy/ directory for boot.md and knowledge files
- **Comprehensive Documentation**:
  - README.md (477 lines): Complete user guide with diagrams
  - ARCHITECTURE.md (864 lines): Deep technical guide
  - TEACHING_GUIDE.md (789 lines): Educational resource with 3-phase learning path
  - 4 hands-on exercises, 12 discussion questions, 10 project ideas, 4-week syllabus

### Changed
- **Bot.py**: Refactored from 277 ‚Üí 140 lines (49% reduction), now facade over Agent
- **Architecture**: Transformed from monolithic to composable (5 layers, 14 files)
- **CLI**: Enhanced with --context, --prompt, --no-boot options
- **Security**: Fixed shell injection vulnerabilities (shlex.quote in search tools)

### Added - v0.2.0 Features
- Configuration system (~/.groqqy/boot.md for apriori knowledge)
- System instruction customization
- Multiple context file support
- Single-shot mode (--prompt flag)

### Technical Details
- Python 3.8+ support
- Standalone implementation using requests (no external AI frameworks)
- Clean separation of concerns across 14 files (all <200 lines)
- Production-ready patterns: logging (loguru + JSONL), cost tracking, error handling
- Follows SOLID principles and design patterns (Facade, Strategy, Registry, Composition)
- Implements ReAct pattern (Yao et al., 2022)

### Testing
- Architecture validation tests (6/6 passing)
- Configuration system tests (all passing)
- Example scripts verified working

## [0.1.0] - 2025-11-27

### Added
- Initial MVP release
- Clean tool-calling bot kernel
- Exemplary Python architecture for AI agent development
- Production-ready patterns (error handling, cost tracking, composability)

---

## Release Notes Template

### [X.Y.Z] - YYYY-MM-DD

#### Added
- New features

#### Changed
- Changes to existing functionality

#### Deprecated
- Soon-to-be removed features

#### Removed
- Removed features

#### Fixed
- Bug fixes

#### Security
- Security improvements
